# JMLR Capability-Risk Experiments

This directory contains the experimental code for validating the theoretical results in the paper "Universal Catastrophic Safety Undecidability and the Capability--Risk Frontier".

## Files

- `cifar_capability_risk.py`: Complete CIFAR-10 experiments with width-scaled ResNet-18, Lipschitz estimation, and PAC-Bayes bounds
- `gridworld_shield.py`: GridWorld environment with Q-learning and runtime shielding
- `plot_frontier.py`: Plotting script for generating figures
- `cifar_frontier_results.json`: Pre-computed results (generated by running experiments)

## Requirements

```bash
pip install torch torchvision numpy matplotlib
```

## Running Experiments

### CIFAR-10 Capability-Risk Frontier

```bash
python cifar_capability_risk.py --cuda --epochs 200 --output cifar_results.json
```

This will train ResNet-18 models with width factors {0.5, 1.0, 2.0} on CIFAR-10 and evaluate robust error under Gaussian noise perturbations.

**Note**: Full training takes ~10 hours on a single RTX 3090. For quick testing, reduce `--epochs` to 10.

### GridWorld Shielding

```bash
python gridworld_shield.py
```

This trains Q-learning agents with and without shields and evaluates catastrophic rates. Takes ~5 minutes on CPU.

### Generate Plots

```bash
python plot_frontier.py
```

This reads `cifar_frontier_results.json` and generates Figure 1 (Lipschitz vs Error) and Figure 2 (PAC-Bayes Ablation).

## Expected Results

- **CIFAR-10**: Robust error scales linearly with Lipschitz constant L, confirming Theorem 3.1
- **GridWorld**: Shielded agent reduces catastrophic rate from ~72% to 0% with ~27% intervention rate, demonstrating Theorem 2.1 implications

## Citation

If you use this code, please cite:

```bibtex
@article{authors2025safety,
  title={Universal Catastrophic Safety Undecidability and the Capability--Risk Frontier},
  author={Authors},
  journal={Journal of Machine Learning Research},
  year={2025}
}
```

